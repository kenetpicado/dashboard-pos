import{o as s,a as d,b as e,e as f,T as F,i as h,j as K,c as R,g as x,h as _,d as u,u as r,r as k,t as v,F as C,w as G,m as H}from"./app-9e6875a3.js";import{_ as J}from"./AppLayout-78482e45.js";import{_ as Q}from"./FormSection-307e5189.js";import{_ as m}from"./InputForm-a46b2f86.js";import{_ as W}from"./FormModal-cda8a3fe.js";import{_ as X}from"./SelectForm-cb4f6e67.js";import{t as j}from"./toast-8d61b9e7.js";import{_ as B}from"./ColorList-5e0ac59a.js";import{I as Y}from"./IconTrash-a5f898c3.js";import{c as Z}from"./createVueComponent-5f77d942.js";import"./_plugin-vue_export-helper-c27b6911.js";var ee=Z("edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);const te={key:0,class:"h-36 w-36"},oe=["src"],le={__name:"ImagePreview",props:{image:{type:Object,required:!0}},setup(i){return(p,l)=>i.image?(s(),d("div",te,[e("img",{src:i.image,onerror:"this.src='/not-found.jpg'",alt:"Imagen",class:"max-h-full max-w-full rounded-lg"},null,8,oe)])):f("",!0)}},ne=e("span",{class:"title"}," Agregar ",-1),ae=e("option",{selected:"",value:""},"Ninguna",-1),ue=["value"],re={class:"col-span-2"},se={class:"overflow-y-auto col-span-2"},de={class:"w-full text-sm text-left text-gray-600 mt-5"},ie=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Colors"),e("th",null,"Medida"),e("th",null,"Precio (ud.)"),e("th",null,"Cant."),e("th",null,"Costo (ud.)"),e("th",null,"Total"),e("th",null,"Acciones")])],-1),ce={class:"divide-y divide-gray-100 border-t border-gray-100"},me={class:"font-bold"},pe={class:"flex gap-2"},ve={key:0,colspan:"6",class:"text-center"},fe=e("td",{colspan:"5",class:"text-right font-bold"}," Costo total ",-1),ye={class:"font-bold"},ge={class:"grid grid-cols-2 gap-4"},_e={id:"measures"},be=["value"],Ve={key:1},he={class:"flex items-center mb-4"},Ce={class:"flex justify-end col-span-2 items-center gap-4"},xe={class:"text-xl font-bold"},Me={__name:"Create",props:{product:{type:Object,required:!1},isNew:{type:Boolean,default:!0},measures:{type:Object,required:!1},categories:{type:Object,required:!1},is_caducable:{type:Boolean,default:!1},manage_colors:{type:Boolean,default:!1}},setup(i){var $,S,U,w,I,N;const p=i,l=F({id:(($=p.product)==null?void 0:$.id)??null,sku:((S=p.product)==null?void 0:S.sku)??null,name:((U=p.product)==null?void 0:U.name)??null,image:((w=p.product)==null?void 0:w.image)??null,discount:((I=p.product)==null?void 0:I.discount)??0,category_id:((N=p.product)==null?void 0:N.category_id)??null,inventory:[],total:0}),y=h("#000000"),c=h([]),n=K({measure:null,quantity:null,cost:null,price:null,expired_at:null,colors:[]}),b=h(!1),g=h(null),M=[{name:"Inicio",route:route("dashboard.index")},{name:"Productos",route:route("dashboard.products.index")},{name:"Crear",route:route("dashboard.products.create")}];function P(){n.colors=[...c.value],g.value!==null?l.inventory[g.value]={...n}:l.inventory.push({...n}),V()}function A(a){l.inventory.splice(a,1)}function T(a){g.value=a,n.measure=l.inventory[a].measure,n.quantity=l.inventory[a].quantity,n.cost=l.inventory[a].cost,n.price=l.inventory[a].price,n.expired_at=l.inventory[a].expired_at,c.value=[...l.inventory[a].colors],b.value=!0,g.value=a}function V(){n.measure=null,n.quantity=null,n.cost=null,n.price=null,n.expired_at=null,c.value=[],b.value=!1,g.value=null}function z(){l.discount||(l.discount=0),p.isNew?(l.total=q.value,l.post(route("dashboard.products.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),j.success("Producto agregado")},onError:a=>{console.log(a)}})):l.put(route("dashboard.products.update",l.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),j.success("Producto actualizado")}})}const q=R(()=>l.inventory.reduce((a,o)=>a+o.quantity*o.cost,0));function E(){y.value&&(c.value.find(a=>a==y.value)||c.value.push(y.value))}function L(a){c.value=c.value.filter(o=>o!=a)}return(a,o)=>(s(),x(J,{title:"Agregar",breads:M},{header:_(()=>[ne]),default:_(()=>[u(Q,{onOnSubmit:z,onOnCancel:o[6]||(o[6]=t=>a.$inertia.visit(a.route("dashboard.products.index")))},{default:_(()=>[u(m,{text:"SKU",modelValue:r(l).sku,"onUpdate:modelValue":o[0]||(o[0]=t=>r(l).sku=t),required:""},null,8,["modelValue"]),u(m,{text:"Nombre",modelValue:r(l).name,"onUpdate:modelValue":o[1]||(o[1]=t=>r(l).name=t),required:""},null,8,["modelValue"]),u(m,{text:"Imagen",modelValue:r(l).image,"onUpdate:modelValue":o[2]||(o[2]=t=>r(l).image=t),type:"url"},null,8,["modelValue"]),u(m,{text:"Descuento",modelValue:r(l).discount,"onUpdate:modelValue":o[3]||(o[3]=t=>r(l).discount=t),type:"number",min:0},null,8,["modelValue"]),u(X,{text:"Categoria",modelValue:r(l).category_id,"onUpdate:modelValue":o[4]||(o[4]=t=>r(l).category_id=t)},{default:_(()=>[ae,(s(!0),d(C,null,k(i.categories,t=>(s(),d("option",{value:t.id},v(t.name),9,ue))),256))]),_:1},8,["modelValue"]),i.isNew?(s(),d(C,{key:0},[e("div",re,[e("button",{class:"primary-button",type:"button",onClick:o[5]||(o[5]=t=>b.value=!0)}," Agregar inventario ")]),e("div",se,[e("table",de,[ie,e("tbody",ce,[(s(!0),d(C,null,k(r(l).inventory,(t,O)=>(s(),d("tr",null,[e("td",null,[u(B,{colors:t.colors},null,8,["colors"])]),e("td",null,v(t.measure),1),e("td",null," C$"+v(t.price),1),e("td",null,v(t.quantity),1),e("td",null,[e("span",me,"C$"+v(t.cost),1)]),e("td",null,"C$"+v((t.quantity*t.cost).toLocaleString()),1),e("td",null,[e("div",pe,[u(r(Y),{role:"button",onClick:D=>A(O),size:"20"},null,8,["onClick"]),u(r(ee),{role:"button",onClick:D=>T(O),size:"20"},null,8,["onClick"])])])]))),256)),e("tr",null,[r(l).inventory.length==0?(s(),d("td",ve," No hay datos que mostrar ")):f("",!0)])]),e("tfoot",null,[e("tr",null,[fe,e("td",ye," C$"+v(q.value.toLocaleString()),1)])])])])],64)):f("",!0)]),_:1}),u(W,{show:b.value,title:"Inventario",onOnCancel:V,onOnSubmit:P},{default:_(()=>[e("div",ge,[e("datalist",_e,[(s(!0),d(C,null,k(i.measures,t=>(s(),d("option",{value:t},null,8,be))),256))]),u(m,{text:"Medida",modelValue:n.measure,"onUpdate:modelValue":o[7]||(o[7]=t=>n.measure=t),required:"",min:1,list:"measures"},null,8,["modelValue"]),u(m,{text:"Cantidad",modelValue:n.quantity,"onUpdate:modelValue":o[8]||(o[8]=t=>n.quantity=t),type:"number",required:"",min:1},null,8,["modelValue"]),u(m,{text:"Costo (Unidad)",modelValue:n.cost,"onUpdate:modelValue":o[9]||(o[9]=t=>n.cost=t),type:"number",required:"",min:1},null,8,["modelValue"]),u(m,{text:"Precio (Unidad)",modelValue:n.price,"onUpdate:modelValue":o[10]||(o[10]=t=>n.price=t),type:"number",required:"",min:1},null,8,["modelValue"]),e("div",null,[i.is_caducable?(s(),x(m,{key:0,text:"Vence",modelValue:n.expired_at,"onUpdate:modelValue":o[11]||(o[11]=t=>n.expired_at=t),type:"date"},null,8,["modelValue"])):f("",!0),i.manage_colors?(s(),d("div",Ve,[e("div",he,[e("button",{type:"button",class:"primary-button mr-4",onClick:E}," Agregar color "),G(e("input",{type:"color","onUpdate:modelValue":o[12]||(o[12]=t=>y.value=t),class:"h-8"},null,512),[[H,y.value]])]),c.value.length>0?(s(),x(B,{key:0,colors:c.value,onRemoveColor:L},null,8,["colors"])):f("",!0)])):f("",!0)]),u(le,{image:r(l).image},null,8,["image"])]),e("div",Ce,[e("div",xe," Total: C$"+v((n.quantity*n.cost).toLocaleString()),1)])]),_:1},8,["show"])]),_:1}))}};export{Me as default};
