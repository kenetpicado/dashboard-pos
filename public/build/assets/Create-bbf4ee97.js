import{_ as v}from"./InputForm-036517a6.js";import{_ as O}from"./SelectForm-758b843a.js";import{_ as w}from"./FormModal-50676e44.js";import{_ as B}from"./AppLayout-c22f2406.js";import{t as f}from"./toast-4e61b110.js";import M from"./SearchProducts-30f5df34.js";import E from"./SelectedProducts-dd50e0f4.js";import{r as c,k as N,l as T,c as D,o as p,g as F,h as _,b as u,t as m,d as i,a as g,F as C,e as S,i as I}from"./app-933f0bf1.js";import"./createVueComponent-f4fa544b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./IconTrash-f1846fad.js";const z={class:"title mt-1"},Q={class:"grid grid-cols-2 gap-4"},R={class:"grid grid-cols-2 gap-4"},A={class:"flex justify-end col-span-2"},G={class:"text-xl font-bold"},H=u("option",{selected:"",disabled:"",value:""},"Seleccionar medida",-1),J=["value"],K={class:"flex justify-end col-span-2"},W={class:"text-xl font-bold text-end"},X={class:"mb-2"},re={__name:"Create",props:{products:{type:Object,required:!1},type:{type:String,required:!0}},setup(r){const d=r,V={buy:"Comprar",sell:"Vender"},U=[{name:"Inicio",route:route("dashboard.users.index")},{name:V[d.type],route:route("dashboard.transactions.create",d.type)}],o=c([]),y=c(!1),b=c(!1),n=c([]),s=c(null),q=c(null),P={id:null,name:null,image:null,quantity:1,cost:null,price:null,measure:null,inventory_id:null},e=N({...P});function k(t){e.id=t.id,e.name=t.name,e.image=t.image,e.quantity=1,d.type=="sell"&&(n.value=t.inventory,s.value=n.value[0].id,e.inventory_id=n.value[0].id),y.value=!0}function h(){if(d.type=="sell"&&e.quantity>x.value){f.error("La cantidad no puede ser mayor a la disponible");return}b.value?(o.value[q.value]={...e},f.success("Producto actualizado")):(o.value.push({...e}),f.success("Producto agregado")),$()}function $(){Object.assign(e,P),b.value=!1,n.value=[],s.value=null,q.value=null,y.value=!1}function j(t){e.id=o.value[t].id,e.name=o.value[t].name,e.image=o.value[t].image,e.quantity=o.value[t].quantity,e.price=o.value[t].price,d.type=="sell"?(n.value=d.products.find(a=>a.id==e.id).inventory,e.inventory_id=o.value[t].inventory_id,s.value=o.value[t].inventory_id):(e.cost=o.value[t].cost,e.measure=o.value[t].measure),b.value=!0,q.value=t,y.value=!0}function L(t){o.value.splice(t,1),f.success("Producto eliminado")}T(()=>s.value,t=>{if(!t)return;const a=n.value.find(l=>l.id==t);e.measure=a.measure,e.price=a.unit_price,e.inventory_id=a.id});const x=D(()=>n.value.length==0||!s.value?0:n.value.find(t=>t.id==s.value).quantity);return(t,a)=>(p(),F(B,{title:V[r.type],breads:U},{header:_(()=>[u("span",z,m(V[r.type]),1)]),default:_(()=>[u("div",Q,[i(M,{products:r.products,onSetProduct:k},null,8,["products"]),i(E,{products:o.value,type:r.type,onEdit:j,onRemove:L},null,8,["products","type"])]),i(w,{show:y.value,title:e.name,onOnCancel:a[6]||(a[6]=l=>$()),onOnSubmit:a[7]||(a[7]=l=>h())},{default:_(()=>[u("div",R,[r.type=="buy"?(p(),g(C,{key:0},[i(v,{text:"Medida",modelValue:e.measure,"onUpdate:modelValue":a[0]||(a[0]=l=>e.measure=l),required:""},null,8,["modelValue"]),i(v,{text:"Cantidad",modelValue:e.quantity,"onUpdate:modelValue":a[1]||(a[1]=l=>e.quantity=l),type:"number",required:"",min:1},null,8,["modelValue"]),i(v,{text:"Costo (Unidad)",modelValue:e.cost,"onUpdate:modelValue":a[2]||(a[2]=l=>e.cost=l),type:"number",required:"",min:1},null,8,["modelValue"]),i(v,{text:"Precio (Unidad)",modelValue:e.price,"onUpdate:modelValue":a[3]||(a[3]=l=>e.price=l),type:"number",required:"",min:1},null,8,["modelValue"]),u("div",A,[u("div",G," Total: "+m((e.quantity*e.cost).toLocaleString()),1)])],64)):S("",!0),r.type=="sell"?(p(),g(C,{key:1},[i(O,{text:"Medida",modelValue:s.value,"onUpdate:modelValue":a[4]||(a[4]=l=>s.value=l),required:""},{default:_(()=>[H,(p(!0),g(C,null,I(n.value,l=>(p(),g("option",{value:l.id},m(l.measure)+" - C$"+m(l.unit_price),9,J))),256))]),_:1},8,["modelValue"]),i(v,{text:"Cantidad",modelValue:e.quantity,"onUpdate:modelValue":a[5]||(a[5]=l=>e.quantity=l),type:"number",required:"",min:1,description:`Disponible: ${x.value}`},null,8,["modelValue","description"]),u("div",K,[u("div",W,[u("div",X,"Precio: C$"+m(e.price.toLocaleString()),1),u("div",null,"Total: C$"+m((e.quantity*e.price).toLocaleString()),1)])])],64)):S("",!0)])]),_:1},8,["show","title"])]),_:1},8,["title"]))}};export{re as default};
