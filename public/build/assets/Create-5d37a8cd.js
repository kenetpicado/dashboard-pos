import{_ as z}from"./AppLayout-8e860020.js";import{T as A,k as E,i as U,c as L,o as s,g as T,h as v,d as r,u as a,a as d,r as b,t as i,F as _,b as e,e as I}from"./app-1585a32c.js";import{_ as D}from"./FormSection-a8ef8693.js";import{_ as c}from"./InputForm-1eae37c8.js";import{_ as F}from"./FormModal-a9fa70de.js";import{_ as K}from"./SelectForm-ff73a172.js";import{t as N}from"./toast-13ef7ed8.js";import{I as G}from"./IconTrash-73c6da6d.js";import{c as H}from"./createVueComponent-298bc17c.js";import"./index-31bee5ed.js";import"./_plugin-vue_export-helper-c27b6911.js";var J=H("edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);const Q=e("span",{class:"title"}," Agregar ",-1),R=e("option",{selected:"",value:""},"Ninguna",-1),W=["value"],X={class:"col-span-2"},Y={class:"overflow-y-auto col-span-2"},Z={class:"w-full text-sm text-left text-gray-600 mt-5"},ee=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Medida"),e("th",null,"Cant."),e("th",null,"Costo (ud.)"),e("th",null,"Total"),e("th",null,"Precio (ud.)"),e("th",null,"Acciones")])],-1),te={class:"divide-y divide-gray-100 border-t border-gray-100"},oe={class:"font-bold"},le={class:"flex gap-2"},ne={key:0,colspan:"6",class:"text-center"},ae=e("td",{colspan:"5",class:"text-right font-bold"}," Costo total ",-1),ue={class:"font-bold"},re={class:"grid grid-cols-2 gap-4"},se={id:"measures"},de=["value"],ie={class:"flex justify-end col-span-2 items-center gap-4"},ce={class:"text-xl font-bold"},qe={__name:"Create",props:{product:{type:Object,required:!1},isNew:{type:Boolean,default:!0},measures:{type:Object,required:!1},categories:{type:Object,required:!1}},setup(y){var h,C,q,k,x,S;const m=y,o=A({id:((h=m.product)==null?void 0:h.id)??null,sku:((C=m.product)==null?void 0:C.sku)??null,name:((q=m.product)==null?void 0:q.name)??null,image:((k=m.product)==null?void 0:k.image)??null,discount:((x=m.product)==null?void 0:x.discount)??0,category_id:((S=m.product)==null?void 0:S.category_id)??null,inventory:[],total:0}),n=E({measure:null,quantity:null,cost:null,price:null}),f=U(!1),p=U(null),w=[{name:"Inicio",route:route("dashboard.index")},{name:"Productos",route:route("dashboard.products.index")},{name:"Crear",route:route("dashboard.products.create")}];function M(){p.value!==null?o.inventory[p.value]={...n}:o.inventory.push({...n}),g()}function O(u){o.inventory.splice(u,1)}function P(u){p.value=u,n.measure=o.inventory[u].measure,n.quantity=o.inventory[u].quantity,n.cost=o.inventory[u].cost,n.price=o.inventory[u].price,f.value=!0,p.value=u}function g(){n.measure=null,n.quantity=null,n.cost=null,n.price=null,f.value=!1,p.value=null}function B(){o.discount||(o.discount=0),m.isNew?(o.total=V.value,o.post(route("dashboard.products.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g(),N.success("Producto agregado")},onError:u=>{console.log(u)}})):o.put(route("dashboard.products.update",o.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g(),N.success("Producto actualizado")}})}const V=L(()=>o.inventory.reduce((u,l)=>u+l.quantity*l.cost,0));return(u,l)=>(s(),T(z,{title:"Agregar",breads:w},{header:v(()=>[Q]),default:v(()=>[r(D,{onOnSubmit:B},{default:v(()=>[r(c,{text:"SKU",modelValue:a(o).sku,"onUpdate:modelValue":l[0]||(l[0]=t=>a(o).sku=t),required:""},null,8,["modelValue"]),r(c,{text:"Nombre",modelValue:a(o).name,"onUpdate:modelValue":l[1]||(l[1]=t=>a(o).name=t),required:""},null,8,["modelValue"]),r(c,{text:"Imagen",modelValue:a(o).image,"onUpdate:modelValue":l[2]||(l[2]=t=>a(o).image=t),type:"url"},null,8,["modelValue"]),r(c,{text:"Descuento",modelValue:a(o).discount,"onUpdate:modelValue":l[3]||(l[3]=t=>a(o).discount=t),type:"number",min:0},null,8,["modelValue"]),r(K,{text:"Categoria",modelValue:a(o).category_id,"onUpdate:modelValue":l[4]||(l[4]=t=>a(o).category_id=t)},{default:v(()=>[R,(s(!0),d(_,null,b(y.categories,t=>(s(),d("option",{value:t.id},i(t.name),9,W))),256))]),_:1},8,["modelValue"]),y.isNew?(s(),d(_,{key:0},[e("div",X,[e("button",{class:"primary-button",type:"button",onClick:l[5]||(l[5]=t=>f.value=!0)}," Agregar inventario ")]),e("div",Y,[e("table",Z,[ee,e("tbody",te,[(s(!0),d(_,null,b(a(o).inventory,(t,$)=>(s(),d("tr",null,[e("td",null,i(t.measure),1),e("td",null,i(t.quantity),1),e("td",null,[e("span",oe,"C$"+i(t.cost),1)]),e("td",null,"C$"+i((t.quantity*t.cost).toLocaleString()),1),e("td",null," C$"+i(t.price),1),e("td",null,[e("div",le,[r(a(G),{role:"button",onClick:j=>O($),size:"20"},null,8,["onClick"]),r(a(J),{role:"button",onClick:j=>P($),size:"20"},null,8,["onClick"])])])]))),256)),e("tr",null,[a(o).inventory.length==0?(s(),d("td",ne," No hay datos que mostrar ")):I("",!0)])]),e("tfoot",null,[e("tr",null,[ae,e("td",ue," C$"+i(V.value.toLocaleString()),1)])])])])],64)):I("",!0)]),_:1}),r(F,{show:f.value,title:"Inventario",onOnCancel:g,onOnSubmit:M},{default:v(()=>[e("div",re,[e("datalist",se,[(s(!0),d(_,null,b(y.measures,t=>(s(),d("option",{value:t},null,8,de))),256))]),r(c,{text:"Medida",modelValue:n.measure,"onUpdate:modelValue":l[6]||(l[6]=t=>n.measure=t),required:"",min:1,list:"measures"},null,8,["modelValue"]),r(c,{text:"Cantidad",modelValue:n.quantity,"onUpdate:modelValue":l[7]||(l[7]=t=>n.quantity=t),type:"number",required:"",min:1},null,8,["modelValue"]),r(c,{text:"Costo (Unidad)",modelValue:n.cost,"onUpdate:modelValue":l[8]||(l[8]=t=>n.cost=t),type:"number",required:"",min:1},null,8,["modelValue"]),r(c,{text:"Precio (Unidad)",modelValue:n.price,"onUpdate:modelValue":l[9]||(l[9]=t=>n.price=t),type:"number",required:"",min:1},null,8,["modelValue"])]),e("div",ie,[e("div",ce," Total: C$"+i((n.quantity*n.cost).toLocaleString()),1)])]),_:1},8,["show"])]),_:1}))}};export{qe as default};
