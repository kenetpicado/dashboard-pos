import{o as s,a as d,b as e,e as f,T as F,i as h,j as K,c as R,g as x,h as _,d as u,u as r,r as q,t as v,F as C,w as G,m as H}from"./app-ea04b834.js";import{_ as J}from"./AppLayout-5505c54b.js";import{_ as Q}from"./FormSection-a0ed5957.js";import{_ as m}from"./InputForm-1ee8b92d.js";import{_ as W}from"./FormModal-34ac5139.js";import{_ as X}from"./SelectForm-8c1e19a8.js";import{t as j}from"./toast-483d16d1.js";import{_ as B}from"./ColorList-b0b1fe9c.js";import{I as Y}from"./IconTrash-d96e6f36.js";import{I as Z}from"./IconEdit-3d00e7a9.js";import"./createVueComponent-9851746b.js";import"./_plugin-vue_export-helper-c27b6911.js";const ee={key:0,class:"h-36 w-36"},te=["src"],oe={__name:"ImagePreview",props:{image:{type:Object,required:!0}},setup(i){return(p,l)=>i.image?(s(),d("div",ee,[e("img",{src:i.image,onerror:"this.src='/not-found.jpg'",alt:"Imagen",class:"max-h-full max-w-full rounded-lg"},null,8,te)])):f("",!0)}},le=e("span",{class:"title"}," Agregar ",-1),ne=e("option",{selected:"",value:""},"Ninguna",-1),ae=["value"],ue={class:"col-span-2"},re={class:"overflow-y-auto col-span-2"},se={class:"w-full text-sm text-left text-gray-600 mt-5"},de=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Colors"),e("th",null,"Medida"),e("th",null,"Precio (ud.)"),e("th",null,"Cant."),e("th",null,"Costo (ud.)"),e("th",null,"Total"),e("th",null,"Acciones")])],-1),ie={class:"divide-y divide-gray-100 border-t border-gray-100"},ce={class:"font-bold"},me={class:"flex gap-2"},pe={key:0,colspan:"6",class:"text-center"},ve=e("td",{colspan:"5",class:"text-right font-bold"}," Costo total ",-1),fe={class:"font-bold"},ye={class:"grid grid-cols-2 gap-4"},ge={id:"measures"},_e=["value"],be={key:1},Ve={class:"flex items-center mb-4"},he={class:"flex justify-end col-span-2 items-center gap-4"},Ce={class:"text-xl font-bold"},Pe={__name:"Create",props:{product:{type:Object,required:!1},isNew:{type:Boolean,default:!0},measures:{type:Object,required:!1},categories:{type:Object,required:!1},is_caducable:{type:Boolean,default:!1},manage_colors:{type:Boolean,default:!1}},setup(i){var $,S,U,w,I,N;const p=i,l=F({id:(($=p.product)==null?void 0:$.id)??null,sku:((S=p.product)==null?void 0:S.sku)??null,name:((U=p.product)==null?void 0:U.name)??null,image:((w=p.product)==null?void 0:w.image)??null,discount:((I=p.product)==null?void 0:I.discount)??0,category_id:((N=p.product)==null?void 0:N.category_id)??null,inventory:[],total:0}),y=h("#000000"),c=h([]),n=K({measure:null,quantity:null,cost:null,price:null,expired_at:null,colors:[]}),b=h(!1),g=h(null),P=[{name:"Inicio",route:route("dashboard.index")},{name:"Productos",route:route("dashboard.products.index")},{name:"Crear",route:route("dashboard.products.create")}];function A(){n.colors=[...c.value],g.value!==null?l.inventory[g.value]={...n}:l.inventory.push({...n}),V()}function T(a){l.inventory.splice(a,1)}function L(a){g.value=a,n.measure=l.inventory[a].measure,n.quantity=l.inventory[a].quantity,n.cost=l.inventory[a].cost,n.price=l.inventory[a].price,n.expired_at=l.inventory[a].expired_at,c.value=[...l.inventory[a].colors],b.value=!0,g.value=a}function V(){n.measure=null,n.quantity=null,n.cost=null,n.price=null,n.expired_at=null,c.value=[],b.value=!1,g.value=null}function M(){l.discount||(l.discount=0),p.isNew?(l.total=k.value,l.post(route("dashboard.products.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),j.success("Producto agregado")},onError:a=>{console.log(a)}})):l.put(route("dashboard.products.update",l.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),j.success("Producto actualizado")}})}const k=R(()=>l.inventory.reduce((a,o)=>a+o.quantity*o.cost,0));function z(){y.value&&(c.value.find(a=>a==y.value)||c.value.push(y.value))}function D(a){c.value=c.value.filter(o=>o!=a)}return(a,o)=>(s(),x(J,{title:"Agregar",breads:P},{header:_(()=>[le]),default:_(()=>[u(Q,{onOnSubmit:M,onOnCancel:o[6]||(o[6]=t=>a.$inertia.visit(a.route("dashboard.products.index")))},{default:_(()=>[u(m,{text:"SKU",modelValue:r(l).sku,"onUpdate:modelValue":o[0]||(o[0]=t=>r(l).sku=t),required:""},null,8,["modelValue"]),u(m,{text:"Nombre",modelValue:r(l).name,"onUpdate:modelValue":o[1]||(o[1]=t=>r(l).name=t),required:""},null,8,["modelValue"]),u(m,{text:"Imagen",modelValue:r(l).image,"onUpdate:modelValue":o[2]||(o[2]=t=>r(l).image=t),type:"url"},null,8,["modelValue"]),u(m,{text:"Descuento",modelValue:r(l).discount,"onUpdate:modelValue":o[3]||(o[3]=t=>r(l).discount=t),type:"number",min:0},null,8,["modelValue"]),u(X,{text:"Categoria",modelValue:r(l).category_id,"onUpdate:modelValue":o[4]||(o[4]=t=>r(l).category_id=t)},{default:_(()=>[ne,(s(!0),d(C,null,q(i.categories,t=>(s(),d("option",{value:t.id},v(t.name),9,ae))),256))]),_:1},8,["modelValue"]),i.isNew?(s(),d(C,{key:0},[e("div",ue,[e("button",{class:"primary-button",type:"button",onClick:o[5]||(o[5]=t=>b.value=!0)}," Agregar inventario ")]),e("div",re,[e("table",se,[de,e("tbody",ie,[(s(!0),d(C,null,q(r(l).inventory,(t,O)=>(s(),d("tr",null,[e("td",null,[u(B,{colors:t.colors},null,8,["colors"])]),e("td",null,v(t.measure),1),e("td",null," C$"+v(t.price),1),e("td",null,v(t.quantity),1),e("td",null,[e("span",ce,"C$"+v(t.cost),1)]),e("td",null,"C$"+v((t.quantity*t.cost).toLocaleString()),1),e("td",null,[e("div",me,[u(r(Y),{role:"button",onClick:E=>T(O),size:"20"},null,8,["onClick"]),u(r(Z),{role:"button",onClick:E=>L(O),size:"20"},null,8,["onClick"])])])]))),256)),e("tr",null,[r(l).inventory.length==0?(s(),d("td",pe," No hay datos que mostrar ")):f("",!0)])]),e("tfoot",null,[e("tr",null,[ve,e("td",fe," C$"+v(k.value.toLocaleString()),1)])])])])],64)):f("",!0)]),_:1}),u(W,{show:b.value,title:"Inventario",onOnCancel:V,onOnSubmit:A},{default:_(()=>[e("div",ye,[e("datalist",ge,[(s(!0),d(C,null,q(i.measures,t=>(s(),d("option",{value:t},null,8,_e))),256))]),u(m,{text:"Medida",modelValue:n.measure,"onUpdate:modelValue":o[7]||(o[7]=t=>n.measure=t),required:"",min:1,list:"measures"},null,8,["modelValue"]),u(m,{text:"Cantidad",modelValue:n.quantity,"onUpdate:modelValue":o[8]||(o[8]=t=>n.quantity=t),type:"number",required:"",min:1},null,8,["modelValue"]),u(m,{text:"Costo (Unidad)",modelValue:n.cost,"onUpdate:modelValue":o[9]||(o[9]=t=>n.cost=t),type:"number",required:"",min:1},null,8,["modelValue"]),u(m,{text:"Precio (Unidad)",modelValue:n.price,"onUpdate:modelValue":o[10]||(o[10]=t=>n.price=t),type:"number",required:"",min:1},null,8,["modelValue"]),e("div",null,[i.is_caducable?(s(),x(m,{key:0,text:"Vence",modelValue:n.expired_at,"onUpdate:modelValue":o[11]||(o[11]=t=>n.expired_at=t),type:"date"},null,8,["modelValue"])):f("",!0),i.manage_colors?(s(),d("div",be,[e("div",Ve,[e("button",{type:"button",class:"primary-button mr-4",onClick:z}," Agregar color "),G(e("input",{type:"color","onUpdate:modelValue":o[12]||(o[12]=t=>y.value=t),class:"h-8"},null,512),[[H,y.value]])]),c.value.length>0?(s(),x(B,{key:0,colors:c.value,onRemoveColor:D},null,8,["colors"])):f("",!0)])):f("",!0)]),u(oe,{image:r(l).image},null,8,["image"])]),e("div",he,[e("div",Ce," Total: C$"+v((n.quantity*n.cost).toLocaleString()),1)])]),_:1},8,["show"])]),_:1}))}};export{Pe as default};
