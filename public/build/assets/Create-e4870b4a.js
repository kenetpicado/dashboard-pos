import{_ as p}from"./InputForm-e5ffaa2b.js";import{_ as C}from"./SelectForm-bdf05745.js";import{_ as B}from"./FormModal-06eb7da5.js";import{_ as E}from"./AppLayout-be198078.js";import{t as g}from"./toast-43701210.js";import M from"./SearchProducts-a61ae740.js";import L from"./SelectedProducts-99f46086.js";import{r as f,l as N,m as T,c as F,o as d,g as I,h as y,b as i,t as c,d as u,a as m,F as V,e as U,i as $}from"./app-577b6edb.js";import"./createVueComponent-08306c2b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./IconTrash-b0192d5f.js";const z={class:"title mt-1"},A={class:"grid grid-cols-2 gap-4"},D={class:"grid grid-cols-2 gap-4"},Q={class:"flex justify-end col-span-2"},R={class:"text-xl font-bold"},G=i("option",{selected:"",disabled:"",value:""},"Seleccionar medida",-1),H=["value"],J=i("option",{selected:"",disabled:"",value:""},"Seleccionar cantidad",-1),K=["value"],W={class:"flex justify-end col-span-2"},X={class:"text-xl font-bold"},se={__name:"Create",props:{products:{type:Object,required:!1},type:{type:String,required:!0}},setup(s){const v=s,q={buy:"Comprar",sell:"Vender"},S=[{name:"Inicio",route:route("dashboard.users.index")},{name:q[v.type],route:route("dashboard.transactions.create",v.type)}],o=f([]),_=f(!1),b=f(!1),n=f([]),r=f(null),P={id:null,name:null,image:null,quantity:1,cost:null,price:null,measure:null,inventory_id:null},e=N({...P});function h(l){if(o.value.find(t=>t.id===l.id)){g.error("Este producto ya ha sido agregado");return}e.id=l.id,e.name=l.name,e.image=l.image,e.quantity=1,v.type=="sell"&&(n.value=l.inventory,r.value=n.value[0].id,e.inventory_id=n.value[0].id),_.value=!0}function j(){if(b.value){const l=o.value.findIndex(t=>t.id===e.id);o.value[l]={...e},g.success("Producto actualizado")}else o.value.push({...e}),g.success("Producto agregado");x()}function x(){Object.assign(e,P),b.value=!1,n.value=[],r.value=null,_.value=!1}function k(l){e.id=o.value[l].id,e.name=o.value[l].name,e.image=o.value[l].image,e.quantity=o.value[l].quantity,e.price=o.value[l].price,v.type=="sell"?(n.value=v.products.find(t=>t.id==e.id).inventory,e.inventory_id=o.value[l].inventory_id,r.value=o.value[l].inventory_id):(e.cost=o.value[l].cost,e.measure=o.value[l].measure),b.value=!0,_.value=!0}function O(l){o.value.splice(l,1),g.success("Producto eliminado")}T(()=>r.value,l=>{if(!l)return;const t=n.value.find(a=>a.id==l);e.measure=t.measure,e.price=t.unit_price,e.inventory_id=t.id});const w=F(()=>{if(n.value.length==0||!r.value)return[1];const l=n.value.find(t=>t.id==r.value).quantity;return Array.from({length:l},(t,a)=>a+1)});return(l,t)=>(d(),I(E,{title:q[s.type],breads:S},{header:y(()=>[i("span",z,c(q[s.type]),1)]),default:y(()=>[i("div",A,[u(M,{products:s.products,onSetProduct:h},null,8,["products"]),u(L,{products:o.value,type:s.type,onEdit:k,onRemove:O},null,8,["products","type"])]),u(B,{show:_.value,title:e.name,onOnCancel:t[7]||(t[7]=a=>x()),onOnSubmit:t[8]||(t[8]=a=>j())},{default:y(()=>[i("div",D,[s.type=="buy"?(d(),m(V,{key:0},[u(p,{text:"Medida",modelValue:e.measure,"onUpdate:modelValue":t[0]||(t[0]=a=>e.measure=a),required:""},null,8,["modelValue"]),u(p,{text:"Cantidad",modelValue:e.quantity,"onUpdate:modelValue":t[1]||(t[1]=a=>e.quantity=a),type:"number",required:"",min:1},null,8,["modelValue"]),u(p,{text:"Costo (Unidad)",modelValue:e.cost,"onUpdate:modelValue":t[2]||(t[2]=a=>e.cost=a),type:"number",required:"",min:1},null,8,["modelValue"]),u(p,{text:"Precio (Unidad)",modelValue:e.price,"onUpdate:modelValue":t[3]||(t[3]=a=>e.price=a),type:"number",required:"",min:1},null,8,["modelValue"]),i("div",Q,[i("div",R," Total: "+c((e.quantity*e.cost).toLocaleString()),1)])],64)):U("",!0),s.type=="sell"?(d(),m(V,{key:1},[u(C,{text:"Medida",modelValue:r.value,"onUpdate:modelValue":t[4]||(t[4]=a=>r.value=a),required:""},{default:y(()=>[G,(d(!0),m(V,null,$(n.value,a=>(d(),m("option",{value:a.id},c(a.measure)+" - C$"+c(a.unit_price),9,H))),256))]),_:1},8,["modelValue"]),u(C,{text:"Cantidad",modelValue:e.quantity,"onUpdate:modelValue":t[5]||(t[5]=a=>e.quantity=a),required:""},{default:y(()=>[J,(d(!0),m(V,null,$(w.value,a=>(d(),m("option",{value:a},c(a),9,K))),256))]),_:1},8,["modelValue"]),u(p,{text:"Precio (Unidad)",modelValue:e.price,"onUpdate:modelValue":t[6]||(t[6]=a=>e.price=a),type:"number",required:""},null,8,["modelValue"]),i("div",W,[i("div",X," Total: C$"+c((e.quantity*e.price).toLocaleString()),1)])],64)):U("",!0)])]),_:1},8,["show","title"])]),_:1},8,["title"]))}};export{se as default};
