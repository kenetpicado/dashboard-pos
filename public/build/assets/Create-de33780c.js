import{_ as z}from"./AppLayout-1b580628.js";import{T as A,k as E,r as S,c as L,o as d,g as T,h as v,d as s,u,a as m,b as e,F as _,i as $,t as r,e as U}from"./app-6f785d1a.js";import{_ as j}from"./FormSection-e70d0101.js";import{_ as i}from"./InputForm-0fe48dbd.js";import{_ as D}from"./FormModal-9558cbb6.js";import{_ as F}from"./SelectForm-0ac61ccf.js";import{t as I}from"./toast-e2691252.js";import{I as K}from"./IconTrash-e7dee912.js";import{c as G}from"./createVueComponent-08b477b0.js";import"./_plugin-vue_export-helper-c27b6911.js";var H=G("edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);const J=e("span",{class:"title"}," Agregar ",-1),Q={class:"col-span-2"},R={class:"overflow-y-auto col-span-2"},W={class:"w-full text-sm text-left text-gray-600 mt-5"},X=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Medida"),e("th",null,"Cant."),e("th",null,"Costo (ud.)"),e("th",null,"Total"),e("th",null,"Precio (ud.)"),e("th",null,"Acciones")])],-1),Y={class:"divide-y divide-gray-100 border-t border-gray-100"},Z={class:"font-bold"},ee={class:"flex gap-2"},te={key:0,colspan:"6",class:"text-center"},oe=e("td",{colspan:"5",class:"text-right font-bold"}," Costo total ",-1),le={class:"font-bold"},ne={class:"grid grid-cols-2 gap-4"},ae=e("option",{selected:"",disabled:"",value:""},"Seleccionar medida",-1),se=["value"],ue={class:"flex justify-end col-span-2 items-center gap-4"},re={class:"text-xl font-bold"},be={__name:"Create",props:{product:{type:Object,required:!1},isNew:{type:Boolean,default:!0},measures:{type:Object,required:!1}},setup(g){var V,h,C,q,k;const c=g,o=A({id:((V=c.product)==null?void 0:V.id)??null,sku:((h=c.product)==null?void 0:h.sku)??null,name:((C=c.product)==null?void 0:C.name)??null,image:((q=c.product)==null?void 0:q.image)??null,discount:((k=c.product)==null?void 0:k.discount)??0,inventory:[],total:0}),n=E({measure:null,quantity:null,cost:null,price:null}),f=S(!1),p=S(null),w=[{name:"Inicio",route:route("dashboard.index")},{name:"Productos",route:route("dashboard.products.index")},{name:"Crear",route:route("dashboard.products.create")}];function N(){p.value!==null?o.inventory[p.value]={...n}:o.inventory.push({...n}),y()}function M(a){o.inventory.splice(a,1)}function P(a){p.value=a,n.measure=o.inventory[a].measure,n.quantity=o.inventory[a].quantity,n.cost=o.inventory[a].cost,n.price=o.inventory[a].price,f.value=!0,p.value=a}function y(){n.measure=null,n.quantity=null,n.cost=null,n.price=null,f.value=!1,p.value=null}function B(){o.discount||(o.discount=0),c.isNew?(o.total=b.value,o.post(route("dashboard.products.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),I.success("Producto agregado")},onError:a=>{console.log(a)}})):o.put(route("dashboard.products.update",o.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),I.success("Producto actualizado")}})}const b=L(()=>o.inventory.reduce((a,l)=>a+l.quantity*l.cost,0));return(a,l)=>(d(),T(z,{title:"Agregar",breads:w},{header:v(()=>[J]),default:v(()=>[s(j,{onOnSubmit:B},{default:v(()=>[s(i,{text:"SKU",modelValue:u(o).sku,"onUpdate:modelValue":l[0]||(l[0]=t=>u(o).sku=t),required:""},null,8,["modelValue"]),s(i,{text:"Name",modelValue:u(o).name,"onUpdate:modelValue":l[1]||(l[1]=t=>u(o).name=t),required:""},null,8,["modelValue"]),s(i,{text:"Image",modelValue:u(o).image,"onUpdate:modelValue":l[2]||(l[2]=t=>u(o).image=t),type:"url"},null,8,["modelValue"]),s(i,{text:"Descuento",modelValue:u(o).discount,"onUpdate:modelValue":l[3]||(l[3]=t=>u(o).discount=t),type:"number",min:0},null,8,["modelValue"]),g.isNew?(d(),m(_,{key:0},[e("div",Q,[e("button",{class:"primary-button",type:"button",onClick:l[4]||(l[4]=t=>f.value=!0)}," Agregar inventario ")]),e("div",R,[e("table",W,[X,e("tbody",Y,[(d(!0),m(_,null,$(u(o).inventory,(t,x)=>(d(),m("tr",null,[e("td",null,r(t.measure),1),e("td",null,r(t.quantity),1),e("td",null,[e("span",Z,"C$"+r(t.cost),1)]),e("td",null,"C$"+r((t.quantity*t.cost).toLocaleString()),1),e("td",null," C$"+r(t.price),1),e("td",null,[e("div",ee,[s(u(K),{role:"button",onClick:O=>M(x),size:"20"},null,8,["onClick"]),s(u(H),{role:"button",onClick:O=>P(x),size:"20"},null,8,["onClick"])])])]))),256)),e("tr",null,[u(o).inventory.length==0?(d(),m("td",te," No hay datos que mostrar ")):U("",!0)])]),e("tfoot",null,[e("tr",null,[oe,e("td",le," C$"+r(b.value.toLocaleString()),1)])])])])],64)):U("",!0)]),_:1}),s(D,{show:f.value,title:"Inventario",onOnCancel:y,onOnSubmit:N},{default:v(()=>[e("div",ne,[s(F,{text:"Medida",modelValue:n.measure,"onUpdate:modelValue":l[5]||(l[5]=t=>n.measure=t),required:""},{default:v(()=>[ae,(d(!0),m(_,null,$(g.measures,t=>(d(),m("option",{value:t},r(t),9,se))),256))]),_:1},8,["modelValue"]),s(i,{text:"Cantidad",modelValue:n.quantity,"onUpdate:modelValue":l[6]||(l[6]=t=>n.quantity=t),type:"number",required:"",min:1},null,8,["modelValue"]),s(i,{text:"Costo (Unidad)",modelValue:n.cost,"onUpdate:modelValue":l[7]||(l[7]=t=>n.cost=t),type:"number",required:"",min:1},null,8,["modelValue"]),s(i,{text:"Precio (Unidad)",modelValue:n.price,"onUpdate:modelValue":l[8]||(l[8]=t=>n.price=t),type:"number",required:"",min:1},null,8,["modelValue"])]),e("div",ue,[e("div",re," Total: C$"+r((n.quantity*n.cost).toLocaleString()),1)])]),_:1},8,["show"])]),_:1}))}};export{be as default};
