import{C as b}from"./Carbon-053ffa43.js";import{o,a as l,b as t,t as d,u as m,k,c as T,l as y,g as v,h as i,d as n,i as h,F as p,n as D,e as C,j as I,O as q}from"./app-933f0bf1.js";import{I as N,_ as w}from"./StatCard-82306114.js";import{T as O}from"./TableSection-17dda05a.js";import{_ as F}from"./ThePaginator-8cfd6558.js";import{_ as L}from"./AppLayout-c22f2406.js";import{_ as P}from"./SelectForm-758b843a.js";import{_ as x}from"./InputForm-036517a6.js";import{I as B}from"./IconCurrencyDollarOff-a137e055.js";import{I as R}from"./IconEye-ba145053.js";import"./createVueComponent-f4fa544b.js";import"./_plugin-vue_export-helper-c27b6911.js";const U={class:"font-medium"},j=["tooltip"],A={__name:"DateColumn",props:{date:{type:String,required:!0}},setup(a){return(_,f)=>(o(),l("div",U,[t("span",{class:"text-gray-700 mb-1",tooltip:m(b).create(a.date).diffForHumans()},d(m(b).create(a.date).format("d/m/Y")),9,j)]))}},E=t("span",{class:"title"}," Transacciones ",-1),z={class:"mb-3"},H={class:"grid grid-cols-5 gap-4"},M=t("option",{selected:"",value:""},"Todos",-1),Y=["value"],G={class:"mb-4"},J={class:"grid grid-cols-5 gap-4"},K=t("th",null,"Fecha",-1),Q=t("th",null,"Factura #",-1),W=t("th",null,"Tipo",-1),X=t("th",null,"Responsable",-1),Z=t("td",null,"Productos",-1),tt=t("th",null,"Descuento",-1),et=t("th",null,"Total",-1),st=t("th",null,"Acciones",-1),ot={class:"hover:bg-gray-50"},at={key:0},rt={class:"font-bold"},nt={class:"flex gap-2"},lt={key:0},dt=t("td",{colspan:"8",class:"text-center"},"No hay datos que mostrar",-1),it=[dt],Vt={__name:"Index",props:{transactions:{type:Object,required:!0},sell_month:{type:Number,required:!0},buy_month:{type:Number,required:!0},users:{type:Object,required:!0}},setup(a){const _=a,f={buy:"COMPRA",sell:"VENTA"},V=[{name:"Inicio",route:route("dashboard.users.index")},{name:"Transacciones",route:route("dashboard.transactions.index")}],$={buy:"badge-red",sell:"badge-indigo"},s=k({user_id:null,from:null,to:null}),S=T(()=>[{title:s.from||s.to?"Compras":"Compras del mes",value:"C$"+_.buy_month.toLocaleString(),icon:B},{title:s.from||s.to?"Ventas":"ventas del mes",value:"C$"+_.sell_month.toLocaleString(),icon:N}]),u=new URLSearchParams(window.location.search);u.get("user_id")&&(s.user_id=u.get("user_id")),u.get("from")&&(s.from=u.get("from")),u.get("to")&&(s.to=u.get("to")),y(()=>s.user_id,c=>{c||delete s.user_id,g()}),y(()=>[s.from,s.to],([c,r])=>{c||delete s.from,r||delete s.to,g()});function g(){q.get(route("dashboard.transactions.index"),s,{preserveState:!0,preserveScroll:!0,only:["transactions","buy_month","sell_month"]})}return(c,r)=>(o(),v(L,{title:"Transacciones",breads:V},{header:i(()=>[E]),default:i(()=>[t("div",z,[t("div",H,[n(P,{text:"Responsable",modelValue:s.user_id,"onUpdate:modelValue":r[0]||(r[0]=e=>s.user_id=e)},{default:i(()=>[M,(o(!0),l(p,null,h(a.users,e=>(o(),l("option",{value:e.id},d(e.name),9,Y))),256))]),_:1},8,["modelValue"]),n(x,{text:"Desde",type:"date",modelValue:s.from,"onUpdate:modelValue":r[1]||(r[1]=e=>s.from=e)},null,8,["modelValue"]),n(x,{text:"Hasta",type:"date",modelValue:s.to,"onUpdate:modelValue":r[2]||(r[2]=e=>s.to=e)},null,8,["modelValue"])])]),t("div",G,[t("div",J,[(o(!0),l(p,null,h(S.value,e=>(o(),v(w,{stat:e,key:e.title},null,8,["stat"]))),128))])]),n(O,null,{header:i(()=>[K,Q,W,X,Z,tt,et,st]),body:i(()=>[(o(!0),l(p,null,h(a.transactions.data,(e,ut)=>(o(),l("tr",ot,[t("td",null,[n(A,{date:e.created_at},null,8,["date"])]),t("td",null," #"+d(e.id.toString().padStart(5,"0")),1),t("td",null,[t("span",{class:D($[e.type])},d(f[e.type]),3)]),t("td",null,d(e.user.name),1),t("td",null,d(e.products_count),1),t("td",null,[e.discount>0?(o(),l("span",at,"C$"+d(e.discount),1)):C("",!0)]),t("td",null,[t("span",rt,"C$"+d(e.total.toLocaleString()),1)]),t("td",null,[t("div",nt,[n(m(I),{href:c.route("dashboard.transactions.show",e.id),tooltip:"Detalles"},{default:i(()=>[n(m(R),{size:"22",role:"button"})]),_:2},1032,["href"])])])]))),256)),a.transactions.data.length==0?(o(),l("tr",lt,it)):C("",!0)]),paginator:i(()=>[n(F,{links:a.transactions.links},null,8,["links"])]),_:1})]),_:1}))}};export{Vt as default};
